# 开发任务与优先级对齐说明

本文档在 **后台管理（Manager）**、**微信小程序（Miniprogram）**、**后端（Application）** 三者之间对齐开发优先级与任务顺序，回答「先做后台的某模块还是先做小程序的某模块」以及「后端与前端如何配合」。

---

## 一、总体原则

1. **后端先行**：凡小程序或后台需要新接口的，优先在后端实现或预留接口，再在前端对接。  
2. **学生端核心流程优先**：学生端「首页 → 申请列表 → 申请详情/表单」是主链路，优先保证数据真实、可审批。  
3. **同一业务尽量后端 → 后台 → 小程序**：例如「通知」：先有后端通知接口，再在后台做通知管理，最后小程序列表/详情接同一套接口。  
4. **已有后端、仅前端未接**：只排前端任务（如申请中心列表接分页接口）。

---

## 二、模块与端对照表

| 业务模块 | 后端状态 | 后台管理 | 微信小程序 | 建议谁先做 |
|----------|----------|----------|------------|------------|
| 认证/用户/资料 | ✅ 已有 | ✅ 已接 | ✅ 已接 | 无需新增 |
| 住宿申请（入住/调宿/退宿/留宿） | ✅ 已有 | ✅ 已接 | 详情/表单已接，**列表未接** | **先小程序接列表** |
| 审批流程 | ✅ 已有 | ✅ 已接 | ✅ 已接 | 无需新增 |
| 宿舍信息/室友/习惯 | ✅ 已有 | ✅ 学生视图已接 | ✅ 已接 | 无需新增 |
| 通知/公告 | ❌ 无 | 无视图 | 详情/已读已接，**列表/首页未接** | **先后端 → 再后台（可选）→ 再小程序列表/首页** |
| 报修 | ❌ 无 | 无视图 | 未接 | **先后端 → 再后台（可选）→ 再小程序** |
| 学生端首页统计 | ❌ 无 | - | 未接 | **先后端 → 再小程序首页** |

---

## 三、分阶段开发任务

### 阶段一：学生端主链路数据真实化（建议最先）

**目标**：首页、申请中心列表使用真实数据，不依赖 Mock。

| 序号 | 任务 | 端 | 说明 |
|------|------|----|------|
| 1.1 | 后端：学生端首页统计接口 | 后端 | 新增 `GET /api/v1/statistics/student-home`，返回待办数、近期申请摘要等（与小程序类型 `IStudentHomeStatistics` 对齐）。 |
| 1.2 | 小程序：首页接入统计 + 申请列表 | 小程序 | 首页调用 `getStudentHomeStatisticsAPI`，用返回数据渲染「近期申请」；水电统计若后端暂无可暂保留前端静态。 |
| 1.3 | 小程序：申请中心 Tab 列表接分页接口 | 小程序 | 调用现有 `getCheckInPageAPI`、`getTransferPageAPI`、`getCheckOutPageAPI`、`getStayPageAPI`，按 Tab 筛选状态后合并或分接口请求。 |

**结论**：本阶段**先做后端 1.1**，再做小程序 1.2、1.3；后台管理无需改。

---

### 阶段二：通知/公告能力闭环

**目标**：首页通知、消息中心、公告详情均走真实通知接口。

| 序号 | 任务 | 端 | 说明 |
|------|------|----|------|
| 2.1 | 后端：通知服务 | 后端 | 新增 `/api/v1/service/notice/*`：分页、详情、发布、编辑、删除、标记已读、未读数量（与小程序 api/service/notice 约定对齐）。 |
| 2.2 | 后台：通知管理页（可选） | 后台 | 新增「通知管理」视图：列表、发布、编辑、删除；依赖 2.1。 |
| 2.3 | 小程序：首页通知列表 + 消息中心列表 | 小程序 | 首页通知区调用 `getNoticePageAPI`；消息中心调用同一套接口 + `getUnreadNoticeCountAPI`。 |

**结论**：**先做后端 2.1**，再做后台 2.2（可选）、小程序 2.3。

---

### 阶段三：报修能力闭环

**目标**：学生可提交报修、查看报修记录；有需要时后台可管理报修。

| 序号 | 任务 | 端 | 说明 |
|------|------|----|------|
| 3.1 | 后端：报修服务 | 后端 | 新增 `/api/v1/service/repair/*`：分页、详情、提交、处理、评价等（与小程序 api/service/repair 约定对齐）。 |
| 3.2 | 后台：报修管理页（可选） | 后台 | 新增「报修管理」视图：列表、处理、状态更新；依赖 3.1。 |
| 3.3 | 小程序：报修列表 + 申请表单报修提交 | 小程序 | 报修记录页接 `getRepairPageAPI`；申请表单中报修类型接 `submitRepairAPI`（去掉「报修功能开发中」占位）。 |

**结论**：**先做后端 3.1**，再做后台 3.2（可选）、小程序 3.3。

---

### 阶段四：后台菜单与入口（按需）

**目标**：管理员能在侧栏看到并访问已有业务视图。

| 序号 | 任务 | 端 | 说明 |
|------|------|----|------|
| 4.1 | 后端：菜单配置 | 后端 | 在系统菜单中配置「住宿管理」「宿舍管理」「组织架构」「学校」「操作日志」等菜单项，确保前端动态路由能加载对应页面。 |
| 4.2 | 后台：确认动态路由 | 后台 | 确认上述菜单下发后，住宿/宿舍/组织/学校/操作日志等页可正常打开且接口正常。 |

**结论**：与后端菜单权限一起做，**后端 4.1 与前端 4.2 可并行**。

---

### 阶段五：小程序样式与体验（可选）

**目标**：部分页面与整体风格统一。

| 序号 | 任务 | 端 | 说明 |
|------|------|----|------|
| 5.1 | 小程序：报修记录/宿舍信息/公告详情样式 | 小程序 | 使用 glass-card、背景装饰等，与首页/个人中心风格统一（见 miniprogram/MINIPROGRAM_STATUS.md 第三节）。 |

**结论**：可在阶段一～三之后排期，不阻塞主流程。

---

## 四、简要优先级结论

| 优先级 | 建议顺序 | 说明 |
|--------|----------|------|
| **P0** | 阶段一（后端统计 → 小程序首页+申请列表） | 学生端主链路数据真实化 |
| **P1** | 阶段二（后端通知 → 可选后台通知管理 → 小程序通知/消息） | 通知能力闭环 |
| **P1** | 阶段三（后端报修 → 可选后台报修管理 → 小程序报修） | 报修能力闭环 |
| **P2** | 阶段四（后台菜单与入口） | 管理员能访问已有业务 |
| **P3** | 阶段五（小程序样式统一） | 体验优化 |

---

## 五、文档索引

- **后台管理**：`manager/MANAGER_STATUS.md`
- **微信小程序**：`miniprogram/MINIPROGRAM_STATUS.md`
- **后端接口**：`Application/BACKEND_STATUS.md`

以上三份文档与本文档一起，用于对齐前后端与双端（Manager + Miniprogram）的开发与排期。
