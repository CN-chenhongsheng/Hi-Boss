-- ============================================================
-- 菜单路径规范化修复脚本
-- 创建日期: 2026-01-30
-- 说明: 将通知管理和报修管理的二级菜单路径从 'list' 改为 'manage'
--      统一菜单命名规范，与其他模块保持一致
-- ============================================================

USE project_management;

-- ============================================================
-- 1. 更新通知管理菜单
-- ============================================================

-- 更新通知管理二级菜单：路径从 'list' 改为 'manage'
UPDATE `sys_menu`
SET
    `menu_name` = '通知管理',
    `path` = 'manage',
    `component` = '/notice/manage',
    `permission` = 'notice:manage:view',
    `update_time` = NOW()
WHERE `id` = 147;

-- ============================================================
-- 2. 更新报修管理菜单
-- ============================================================

-- 更新报修管理二级菜单：路径从 'list' 改为 'manage'
UPDATE `sys_menu`
SET
    `path` = 'manage',
    `component` = '/repair/manage',
    `permission` = 'repair:manage:view',
    `update_time` = NOW()
WHERE `id` = 153;

-- ============================================================
-- 3. 验证修改结果
-- ============================================================

SELECT
    id AS '菜单ID',
    menu_name AS '菜单名称',
    menu_type AS '类型',
    path AS '路径',
    component AS '组件路径',
    permission AS '权限标识'
FROM `sys_menu`
WHERE id IN (147, 153);

-- ============================================================
-- 预期结果:
-- +--------+--------------+------+---------+----------------+-------------------+
-- | 菜单ID | 菜单名称     | 类型 | 路径    | 组件路径       | 权限标识          |
-- +--------+--------------+------+---------+----------------+-------------------+
-- | 147    | 通知管理     | C    | manage  | /notice/manage | notice:manage:view|
-- | 153    | 报修工单     | C    | manage  | /repair/manage | repair:manage:view|
-- +--------+--------------+------+---------+----------------+-------------------+
-- ============================================================

-- ============================================================
-- 执行说明
-- ============================================================
--
-- 执行方式:
-- mysql -u root -p project_management < Application/sql/fix_menu_path_naming.sql
--
-- 注意事项:
-- 1. 执行此脚本后，需要同步修改前端目录和路由配置
-- 2. 前端需要将 views/repair/list 重命名为 views/repair/manage
-- 3. 前端需要将 views/notice/list 重命名为 views/notice/manage（如果存在）
-- 4. 前端需要修改所有引用旧路径的地方
--
-- 回滚方式:
-- 如需回滚，执行以下SQL:
--
-- UPDATE `sys_menu` SET menu_name='通知列表', path='list', component='/notice/list', permission='notice:list:view' WHERE id=147;
-- UPDATE `sys_menu` SET path='list', component='/repair/list', permission='repair:list:view' WHERE id=153;
--
-- ============================================================
